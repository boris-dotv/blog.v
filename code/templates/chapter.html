<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="$lang$" xml:lang="$lang$"$if(dir)$ dir="$dir$"$endif$>
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <link rel="shortcut icon" type="image/x-icon" href="favicon.ico">

  <!-- Add Open Graph meta tags for share image -->
  <meta property="og:image" content="https://raw.githubusercontent.com/natolambert/rlhf-book/main/images/rlhf-book-share.png" />
  <meta property="og:image:width" content="1920" />
  <meta property="og:image:height" content="1080" />
  
  <!-- <meta property="og:title" content="$if(title-prefix)$$title-prefix$ â€“ $endif$$pagetitle$" /> -->
  <meta property="og:title" content="$if(page-title)$$page-title$$else$$title$$endif$ | RLHF Book by Boris .v" />
  <meta property="og:description" content="The Blog.v Book" />
  <meta property="og:url" content="https://rlhfbook.com" />

  $for(author-meta)$
  <meta name="author" content="$author-meta$" />
$endfor$
$if(date-meta)$
  <meta name="dcterms.date" content="$date-meta$" />
$endif$
$if(keywords)$
  <meta name="keywords" content="$for(keywords)$$keywords$$sep$, $endfor$" />
$endif$
  <!-- <title>RLHF Book</title> -->
   <!-- SEO and Open Graph titles -->
   <title>
    $if(page-title)$
      $page-title$ | RLHF Book by Boris .v
    $else$
      $title$ | RLHF Book by Boris .v
    $endif$
  </title>
  
  <style>
    $styles.html()$
    $style.css()$
  </style>
<link rel="stylesheet" href="../style.css" />
$if(math)$
  $math$
  <style>
    /* Target all possible MathJax display containers */
    .MathJax_Display, .MJXc-display, .math.display, mjx-container[jax="CHTML"][display="true"], mjx-container[jax="SVG"][display="true"] {
      overflow-x: auto;
      max-width: 100%;
      padding: 0.5em 0;
    }
  </style>
$endif$
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
$for(header-includes)$
  $header-includes$
$endfor$

<!-- custom js nav -->
<script src="nav.js" defer></script>
<script src="header-anchors.js" defer></script>
<script src="table-scroll.js" defer></script>
<!-- åœ¨ head ç»“æŸå‰æ·»åŠ  -->
<script src="sidebar.js" defer></script> 
</head> <!-- è¿™é‡Œæ˜¯åŸæœ¬çš„ /head -->

<body>
$for(include-before)$
$include-before$
$endfor$

<!-- 1. é¡¶éƒ¨å¯¼èˆª (ä¿æŒä¸å˜) -->
$if(title)$
<header id="title-block-header">
<h1 class="title"><a href="https://rlhfbook.com/" style="color: inherit; text-decoration: none;">$title$</a></h1>
$if(subtitle)$
<p class="subtitle">$subtitle$</p>
$endif$
$for(author)$
<p class="author">$author$</p>
$endfor$
<navigation-dropdown expanded="false"></navigation-dropdown>
</header>
$endif$

<!-- 2. é¡µé¢å¸ƒå±€å®¹å™¨ï¼šä¾§è¾¹æ  + æ­£æ–‡ -->
<div class="page-wrapper">
  
  <!-- å·¦ä¾§è¾¹æ  -->
  <aside id="sidebar">
    <div class="sticky-container">
        <!-- å¦‚æœä½ æƒ³æ‰‹åŠ¨åŠ ç« èŠ‚åˆ—è¡¨ï¼Œå¯ä»¥åœ¨è¿™é‡ŒåŠ  -->
        <!-- <div class="global-toc"> <a href="index.html">Home</a> ... </div> -->
        
        <!-- JS ä¼šæŠŠå½“å‰é¡µç›®å½•æ³¨å…¥åˆ°è¿™é‡Œ -->
        <div id="sidebar-content"></div>
    </div>
  </aside>

  <!-- å³ä¾§æ­£æ–‡åŒºåŸŸ -->
  <main class="main-content">
    
    <div> <h3> Chapter Contents </h3> </div>
    
    <!-- è¿™é‡Œæ˜¯ Pandoc ç”Ÿæˆçš„å±…ä¸­ç›®å½•ï¼Œä¿ç•™å®ƒ -->
    $if(toc)$
    <nav id="$idprefix$TOC" role="doc-toc">
    $if(toc-title)$
    <h2 id="$idprefix$toc-title">$toc-title$</h2>
    $endif$
    $table-of-contents$
    </nav>
    $endif$

    <div id="content">
      $body$
    </div>

    <div id="chapter-navigation" style="display: flex; justify-content: space-between; padding: 2em 0;">
      $if(prev-url)$
      <a href="$prev-url$" class="prev-chapter">
        â† Previous: $prev-chapter$
      </a>
      $else$
      <div></div>
      $endif$
      
      $if(next-url)$
      <a href="$next-url$" class="next-chapter">
        Next: $next-chapter$ â†’
      </a>
      $endif$
    </div>

  </main>
</div>
<!-- page-wrapper ç»“æŸ -->

$for(include-after)$
$include-after$
$endfor$

<!-- Footer ä¿æŒä¸å˜ -->
<footer style="padding: 20px; text-align: center;">
  <!-- ... existing footer content ... -->
  <hr>
  <p>&copy; 2025 Boris .v</p>
</footer>
<!-- COPY BUTTON SCRIPT START (TIGHT SPACING & PREMIUM UI) -->
<script>
(function() {
    console.log("ğŸš€ Premium Copy Button Script Loaded (Compact Version)");

    const styleSheet = document.createElement("style");
    styleSheet.innerText = `
        /* [1] å¤–å£³ï¼šè´Ÿè´£èƒŒæ™¯ã€åœ†è§’ã€é˜´å½± */
        .code-wrapper {
            position: relative;
            margin: 1.5em 0;
            width: 100%;
            display: block;
            border-radius: 8px;
            background-color: #1E222A;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(255, 255, 255, 0.08);
        }
        
        /* çº¢ç»¿ç¯ï¼šç¨å¾®ä¸Šç§»ä¸€ç‚¹ï¼Œæ›´ç´§å‡‘ */
        .code-wrapper::before {
            content: '';
            position: absolute;
            top: 14px; /* åŸæ¥æ˜¯ 16pxï¼Œå¾€ä¸Šæ */
            left: 14px;
            z-index: 20;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #FF5F56;
            box-shadow: 18px 0 0 #FFBD2E, 36px 0 0 #27C93F;
            opacity: 1;
        }

        /* [2] ä¸­é—´å±‚ï¼šå½»åº•æ¸…é™¤å¹²æ‰° */
        .code-wrapper div.sourceCode {
            margin: 0 !important;
            padding: 0 !important;
            background: transparent !important;
            border: none !important;
            box-shadow: none !important;
            width: 100%;
            overflow-x: auto;
        }

        /* [3] å†…å±‚ PREï¼šä¿®æ­£é¡¶éƒ¨é—´è· */
        .code-wrapper pre {
            margin: 0 !important;
            background: transparent !important;
            border: none !important;
            
            /* æ ¸å¿ƒä¿®æ”¹ï¼šä» 2.8em é™åˆ° 2.4emï¼Œæ¶ˆé™¤å¤šä½™ç©ºç™½ */
            /* 2.4em * 14px â‰ˆ 33.6pxï¼Œåˆšå¥½ç›–è¿‡ 14px(top) + 10px(height) + ç¼“å†² */
            padding: 2.6em   2em    2em    2em   !important;
            
            font-family: "JetBrains Mono", "Fira Code", Consolas, monospace;
            font-size: 14px;
            line-height: 1.5; /*ç¨å¾®è°ƒå°ä¸€ç‚¹è¡Œé«˜ï¼Œè®©ä»£ç æ›´ç´§å‡‘*/
            color: #A6ACCD;
            width: max-content;
            min-width: 100%;
        }

        /* [4] ç¡®ä¿ code æ ‡ç­¾æ²¡æœ‰ä»»ä½•è¾¹è· */
        .code-wrapper pre > code {
            padding: 1.0em !important;
            margin: 0 !important;
            display: block; /* ç¡®ä¿å®ƒè´´åˆ pre */
        }

        /* éšè—åŸæ¥çš„è£…é¥° */
        div.sourceCode::before, pre::before, code::before {
            display: none !important;
            content: none !important;
        }

        /* [5] Copy æŒ‰é’®ï¼šä½ç½®å¾®è°ƒï¼Œé…åˆæ›´ç´§å‡‘çš„é¡¶éƒ¨ */
        .copy-btn {
            position: absolute;
            top: 6px;   /* è·Ÿéšçº¢ç»¿ç¯ä¸Šç§» */
            right: 8px;
            z-index: 100;
            
            /* å¸ƒå±€ */
            display: flex !important;
            align-items: center;
            justify-content: center;
            
            /* å­—ä½“ */
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            font-size: 11px; /* ç¨å¾®ç¼©å°ä¸€ç‚¹å­—ä½“ */
            font-weight: 500;
            line-height: 1;
            padding: 5px 10px;
            border-radius: 6px;
            
            /* è´¨æ„Ÿ */
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: #6c7393;
            backdrop-filter: blur(5px);
            
            /* äº¤äº’ */
            cursor: pointer;
            transition: all 0.2s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            opacity: 0;
            transform: translateY(2px);
        }

        .code-wrapper:hover .copy-btn {
            opacity: 1;
            transform: translateY(0);
        }

        .copy-btn:hover {
            background: rgba(255, 255, 255, 0.15);
            color: #ffffff;
            border-color: rgba(255, 255, 255, 0.25);
        }

        .copy-btn:active {
            transform: scale(0.95);
        }

        .copy-btn.copied {
            background: rgba(195, 232, 141, 0.15);
            color: #C3E88D;
            border-color: rgba(195, 232, 141, 0.3);
        }
    `;
    document.head.appendChild(styleSheet);

    document.addEventListener('DOMContentLoaded', function() {
        const targets = document.querySelectorAll('div.sourceCode, pre:not(.sourceCode pre)'); 
        targets.forEach((block, index) => {
            if (block.parentNode.classList.contains('code-wrapper')) return;
            try {
                const wrapper = document.createElement('div');
                wrapper.className = 'code-wrapper';
                block.parentNode.insertBefore(wrapper, block);
                wrapper.appendChild(block);
                
                const btn = document.createElement('button');
                btn.className = 'copy-btn';
                btn.innerText = 'Copy';
                
                btn.onclick = function() {
                    const text = block.textContent;
                    navigator.clipboard.writeText(text).then(() => {
                        btn.innerText = 'Copied';
                        btn.classList.add('copied');
                        setTimeout(() => {
                            btn.innerText = 'Copy';
                            btn.classList.remove('copied');
                        }, 2000);
                    }).catch(err => {
                        console.error('Copy failed', err);
                        btn.innerText = 'Error';
                    });
                };
                wrapper.appendChild(btn);
            } catch (e) {
                console.error(`Failed to process block ${index}`, e);
            }
        });
    });
})();
document.addEventListener('DOMContentLoaded', function() {
    // 1. åœ¨é¡µé¢ä¸Šåˆ›å»ºä¸€ä¸ªå”¯ä¸€çš„æ¨¡æ€æ¡†ç»“æ„
    const modalHTML = `
        <div class="tutor-modal-overlay" id="python-tutor-modal">
            <div class="tutor-modal-content">
                <button class="tutor-modal-close" title="Close">&times;</button>
                <iframe src="" frameborder="0"></iframe>
            </div>
        </div>
    `;
    document.body.insertAdjacentHTML('beforeend', modalHTML);

    const modalOverlay = document.getElementById('python-tutor-modal');
    const modalIframe = modalOverlay.querySelector('iframe');
    const closeModalBtn = modalOverlay.querySelector('.tutor-modal-close');

    // 2. æ‰¾åˆ°æ‰€æœ‰çš„ "å¯è§†åŒ–" æŒ‰é’®å¹¶æ·»åŠ ç‚¹å‡»äº‹ä»¶
    const visualizeButtons = document.querySelectorAll('.visualize-btn');
    visualizeButtons.forEach(button => {
        button.addEventListener('click', function() {
            const tutorSrc = this.getAttribute('data-tutor-src');
            if (tutorSrc) {
                modalIframe.src = tutorSrc; // åŠ è½½å¯¹åº”çš„ Tutor é“¾æ¥
                modalOverlay.classList.add('visible'); // æ˜¾ç¤ºæ¨¡æ€æ¡†
            }
        });
    });

    // 3. å®šä¹‰å…³é—­æ¨¡æ€æ¡†çš„å‡½æ•°
    function closeModal() {
        modalOverlay.classList.remove('visible');
        // éå¸¸é‡è¦ï¼šå…³é—­æ—¶æ¸…ç©º srcï¼Œåœæ­¢ iframe åŠ è½½ï¼ŒèŠ‚çœèµ„æº
        modalIframe.src = ''; 
    }

    // 4. ä¸ºå…³é—­æŒ‰é’®å’ŒèƒŒæ™¯é®ç½©æ·»åŠ å…³é—­äº‹ä»¶
    closeModalBtn.addEventListener('click', closeModal);
    modalOverlay.addEventListener('click', function(event) {
        // ç¡®ä¿åªåœ¨ç‚¹å‡»èƒŒæ™¯æ—¶å…³é—­ï¼Œè€Œä¸æ˜¯ç‚¹å‡»å†…å®¹åŒº
        if (event.target === modalOverlay) {
            closeModal();
        }
    });
    
    // 5. æ·»åŠ  ESC é”®å…³é—­åŠŸèƒ½
    document.addEventListener('keydown', function(event) {
        if (event.key === 'Escape' && modalOverlay.classList.contains('visible')) {
            closeModal();
        }
    });
});
</script>
<!-- COPY BUTTON SCRIPT END -->
</body>
</html>
